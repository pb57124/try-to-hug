require=function s(n,c,a){function p(t,e){if(!c[t]){if(!n[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(l)return l(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=c[t]={exports:{}};n[t][0].call(r.exports,function(e){return p(n[t][1][e]||e)},r,r.exports,s,n,c,a)}return c[t].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)p(a[e]);return p}({Board:[function(e,t,o){"use strict";cc._RF.push(t,"cd24ekgD7BPBaveoempkjn3","Board"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Player"),r=e("../Constants"),s=cc._decorator,n=s.ccclass,c=s.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player1=null,e.player2=null,e.roomScene=null,e}return __extends(e,t),e.prototype.init=function(e){this.roomScene=e,this.player1.init(r.PLAYER_ROLE.ATTACK,this),this.player2.init(r.PLAYER_ROLE.DEFEND,this)},e.prototype.onCollide=function(){var e,t;if(this.player1.role===r.PLAYER_ROLE.ATTACK?(e=this.player1,t=this.player2):(e=this.player2,t=this.player1),this.getComponent(cc.AudioSource).play(),t.isAddArmor){var o=t.node.x-e.node.x,i=t.node.y-e.node.y;Math.abs(o)>Math.abs(i)?0<o?e.rebound(r.DIRECTION.LEFT):e.rebound(r.DIRECTION.RIGHT):0<i?e.rebound(r.DIRECTION.DOWN):e.rebound(r.DIRECTION.UP)}else this.roomScene.onHug()},e.prototype.movePlayer1=function(e){this.player1.move(e)},e.prototype.skillPlayer1=function(){this.player1.useSkill()},e.prototype.tryStopPlayer1=function(e){this.player1.tryStop(e)},e.prototype.movePlayer2=function(e){this.player2.move(e)},e.prototype.skillPlayer2=function(){this.player2.useSkill()},e.prototype.tryStopPlayer2=function(e){this.player2.tryStop(e)},e.prototype.pausePlayers=function(){this.player1.pause(),this.player2.pause()},e.prototype.activePlayers=function(e){e%2==1?(this.player1.active(r.PLAYER_ROLE.ATTACK),this.player2.active(r.PLAYER_ROLE.DEFEND)):(this.player1.active(r.PLAYER_ROLE.DEFEND),this.player2.active(r.PLAYER_ROLE.ATTACK))},__decorate([c(i.Player)],e.prototype,"player1",void 0),__decorate([c(i.Player)],e.prototype,"player2",void 0),e=__decorate([n],e)}(cc.Component);o.Board=a,cc._RF.pop()},{"../Constants":"Constants","./Player":"Player"}],Button1:[function(e,t,o){"use strict";cc._RF.push(t,"b994cc7gWNMm71EAaq1VLoF","Button1"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onBtn1ShowFrame=function(){this.node.getChildByName("effect").active=!0},t.prototype.onBtn1HideFrame=function(){this.node.getChildByName("effect").active=!1},t=__decorate([r],t)}(cc.Component));o.default=s,cc._RF.pop()},{}],Button2:[function(e,t,o){"use strict";cc._RF.push(t,"c0f8aINT1JG74UEFRswApKo","Button2"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onBtn2ShowFrame=function(){this.node.getChildByName("effect").active=!0},t.prototype.onBtn2HideFrame=function(){this.node.getChildByName("effect").active=!1},t=__decorate([r],t)}(cc.Component));o.default=s,cc._RF.pop()},{}],Constants:[function(e,t,o){"use strict";var i,r,s;cc._RF.push(t,"20b56pZ66VOq58Zks3nqrU8","Constants"),Object.defineProperty(o,"__esModule",{value:!0}),(i=o.DIRECTION||(o.DIRECTION={}))[i.LEFT=-1]="LEFT",i[i.RIGHT=1]="RIGHT",i[i.UP=2]="UP",i[i.DOWN=-2]="DOWN",i[i.IDLE=0]="IDLE",(r=o.PLAYER_ROLE||(o.PLAYER_ROLE={}))[r.NONE=0]="NONE",r[r.ATTACK=1]="ATTACK",r[r.DEFEND=-1]="DEFEND",(s=o.PLAYER_STATE||(o.PLAYER_STATE={}))[s.NONE=0]="NONE",s[s.NORMAL=1]="NORMAL",s[s.FREEZE=2]="FREEZE",s[s.SPEED=3]="SPEED",cc._RF.pop()},{}],G:[function(e,t,o){"use strict";cc._RF.push(t,"4903ewQQKFFWrEG3jg+D/f0","G"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){}return e.Instance=new e,e}();o.G=i.Instance,cc._RF.pop()},{}],HugPanel:[function(e,t,o){"use strict";cc._RF.push(t,"d58f2c+GgVJ7JvkIsoKkwIx","HugPanel"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("../Constants"),r=cc._decorator,s=r.ccclass,n=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.helpFrameNode=null,e.noFrameNode=null,e.progressBar=null,e.progress=0,e}return __extends(e,t),e.prototype.init=function(e){this.roomScene=e},e.prototype.show=function(){var e=this;cc.log("show"),this.node.parent.active=!0,this.progress=50,this.progressBar.progress=this.progress/100,this.addListeners(),setTimeout(function(){e.hide()},5e3)},e.prototype.hide=function(){this.node.parent.active=!1,this.removeListeners(),this.roomScene.onHugOver(this.progress)},e.prototype.onPlayer1Click=function(){this.roomScene.board.player1.role===i.PLAYER_ROLE.ATTACK?(this.progress+=2,100<this.progress&&(this.progress=100)):(this.progress-=1,this.progress<0&&(this.progress=0)),this.progressBar.progress=this.progress/100},e.prototype.onPlayer2Click=function(){this.roomScene.board.player1.role===i.PLAYER_ROLE.ATTACK?(this.progress-=1,this.progress<0&&(this.progress=0)):(this.progress+=2,100<this.progress&&(this.progress=100)),this.progressBar.progress=this.progress/100},e.prototype.addListeners=function(){var t=this;cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){e.keyCode===cc.KEY.space?t.onPlayer1Click():e.keyCode===cc.KEY.enter&&t.onPlayer2Click()},this)},e.prototype.removeListeners=function(){cc.systemEvent.targetOff(this)},e.prototype.onHelpFrame=function(){this.helpFrameNode.active=!0},e.prototype.onNoFrame=function(){this.helpFrameNode.active=!1,this.noFrameNode.active=!0},e.prototype.onHideFrame=function(){this.noFrameNode.active=!1},__decorate([n(cc.Node)],e.prototype,"helpFrameNode",void 0),__decorate([n(cc.Node)],e.prototype,"noFrameNode",void 0),__decorate([n(cc.ProgressBar)],e.prototype,"progressBar",void 0),e=__decorate([s],e)}(cc.Component);o.HugPanel=c,cc._RF.pop()},{"../Constants":"Constants"}],LoadingScene:[function(e,t,o){"use strict";cc._RF.push(t,"662614U3SpMXYS/0qTozTBY","LoadingScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){},t.prototype.startGame=function(){cc.director.loadScene("room")},t=__decorate([r],t)}(cc.Component));o.LoadingScene=s,cc._RF.pop()},{}],OverPanel:[function(e,t,o){"use strict";cc._RF.push(t,"e263dOl7EhHGJazTNa7FOau","OverPanel"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.firstLabel=null,e.secondLabel=null,e.firstPlayer1Icon=null,e.firstPlayer2Icon=null,e.secondPlayer1Icon=null,e.secondPlayer2Icon=null,e}return __extends(e,t),e.prototype.show=function(e,t,o){this.node.active=!0,this.firstLabel.string=t+"",this.secondLabel.string=o+"",e?(this.firstPlayer1Icon.active=!0,this.firstPlayer2Icon.active=!1,this.secondPlayer1Icon.active=!1,this.secondPlayer2Icon.active=!0):(this.firstPlayer1Icon.active=!1,this.firstPlayer2Icon.active=!0,this.secondPlayer1Icon.active=!0,this.secondPlayer2Icon.active=!1)},__decorate([s(cc.Label)],e.prototype,"firstLabel",void 0),__decorate([s(cc.Label)],e.prototype,"secondLabel",void 0),__decorate([s(cc.Node)],e.prototype,"firstPlayer1Icon",void 0),__decorate([s(cc.Node)],e.prototype,"firstPlayer2Icon",void 0),__decorate([s(cc.Node)],e.prototype,"secondPlayer1Icon",void 0),__decorate([s(cc.Node)],e.prototype,"secondPlayer2Icon",void 0),e=__decorate([r],e)}(cc.Component);o.OverPanel=n,cc._RF.pop()},{}],Player:[function(e,t,o){"use strict";cc._RF.push(t,"8578cDbAzxDg40VANQMJxtH","Player"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Constants"),i=cc._decorator,r=i.ccclass,s=i.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=200,e.animation=null,e.dir=n.DIRECTION.IDLE,e.lastSkillTime=0,e}return __extends(e,t),e.prototype.onLoad=function(){this.oriPos=this.node.position},e.prototype.resetPos=function(){this.node.position=this.oriPos},e.prototype.init=function(e,t){this.collisionX=0,this.collisionY=0,this.touchingNumber=0,this.isAddSpeed=!1,this.isAddArmor=!1,this.isFreeze=!1,this.role=e,this.state=n.PLAYER_STATE.NONE,this.moveActions=[],this.board=t},e.prototype.active=function(e){this.role=e,this.state=n.PLAYER_STATE.NORMAL,this.resetPos()},e.prototype.pause=function(){this.state=n.PLAYER_STATE.NONE},e.prototype.resume=function(){this.state=n.PLAYER_STATE.NORMAL,this.resetPos()},e.prototype.useSkill=function(){if(this.state!==n.PLAYER_STATE.NONE){var e=(new Date).getTime();1e3<e-this.lastSkillTime&&(this.role===n.PLAYER_ROLE.ATTACK?this.addSpeed():this.addArmor(),this.lastSkillTime=e)}},e.prototype.addSpeed=function(){var e=this;this.isAddSpeed=!0,this.node.getChildByName("dialog").getChildByName("label").getComponent(cc.Label).string="抱",this.node.getChildByName("dialog").active=!0,setTimeout(function(){e.isAddSpeed=!1},100),setTimeout(function(){e.node.getChildByName("dialog").active=!1},500)},e.prototype.addArmor=function(){var e=this;this.isFreeze||(this.isAddArmor=!0,this.node.getChildByName("skill").active=!0,this.dir=n.DIRECTION.IDLE,this.node.getChildByName("dialog").getChildByName("label").getComponent(cc.Label).string="滚",this.node.getChildByName("dialog").active=!0,setTimeout(function(){e.isAddArmor=!1,e.node.getChildByName("skill").active=!1,e.updateDir(),e.node.getChildByName("dialog").active=!1},500))},e.prototype.freeze=function(){var e=this;this.isFreeze=!0,this.node.getChildByName("freeze").active=!0,this.dir=n.DIRECTION.IDLE,setTimeout(function(){e.isFreeze=!1,e.node.getChildByName("freeze").active=!1,e.updateDir()},2e3)},e.prototype.rebound=function(e){var t=this;this.dir=e,this.isAddSpeed=!0,setTimeout(function(){t.isAddSpeed=!1},100)},e.prototype.move=function(e){e!==this.dir&&(this.moveActions.push(e),this.updateDir())},e.prototype.updateDir=function(){var e;switch(e=0<this.moveActions.length?this.moveActions[this.moveActions.length-1]:n.DIRECTION.IDLE,this.dir=e,this.dir){case n.DIRECTION.LEFT:this.animation.play("move_left");break;case n.DIRECTION.RIGHT:this.animation.play("move_right");break;case n.DIRECTION.UP:this.animation.play("move_up");break;case n.DIRECTION.DOWN:this.animation.play("move_down")}},e.prototype.tryStop=function(e){var t=this.moveActions.indexOf(e);this.moveActions.splice(t),this.dir===e&&this.updateDir()},e.prototype.onCollisionEnter=function(e,t){this.touchingNumber++;var o=e.world.aabb,i=e.world.preAabb.clone(),r=t.world.aabb,s=t.world.preAabb.clone();s.x=r.x,i.x=o.x,cc.Intersection.rectRect(s,i)&&(this.dir===n.DIRECTION.LEFT&&s.xMax>i.xMax?(this.node.x+=i.xMax-r.xMin+1,this.collisionX=-1):this.dir===n.DIRECTION.RIGHT&&s.xMin<i.xMin&&(this.node.x-=r.xMax-i.xMin+1,this.collisionX=1),this.dir=n.DIRECTION.IDLE,e.touchingX=!0),s.y=r.y,i.y=o.y,cc.Intersection.rectRect(s,i)&&(this.dir===n.DIRECTION.DOWN&&s.yMax>i.yMax?(this.node.y+=i.yMax-r.yMin+1,this.collisionY=-1):this.dir===n.DIRECTION.UP&&s.yMin<i.yMin&&(this.node.y-=r.yMax-i.yMin+1,this.collisionY=1),this.dir=n.DIRECTION.IDLE,e.touchingY=!0),1===e.tag&&this.role===n.PLAYER_ROLE.ATTACK&&this.board.onCollide(),4===e.tag&&this.freeze()},e.prototype.onCollisionExit=function(e){this.touchingNumber--,0===this.touchingNumber&&(this.node.color=cc.Color.WHITE),e.touchingX?(this.collisionX=0,e.touchingX=!1):e.touchingY&&(e.touchingY=!1,this.collisionY=0)},e.prototype.update=function(e){if(this.state!==n.PLAYER_STATE.NONE&&this.dir!==n.DIRECTION.IDLE&&!this.isAddArmor&&!this.isFreeze)switch(this.dir){case n.DIRECTION.LEFT:this.node.x-=this.isAddSpeed?this.speed*e*4:this.speed*e;break;case n.DIRECTION.RIGHT:this.node.x+=this.isAddSpeed?this.speed*e*4:this.speed*e;break;case n.DIRECTION.UP:this.node.y+=this.isAddSpeed?this.speed*e*4:this.speed*e;break;case n.DIRECTION.DOWN:this.node.y-=this.isAddSpeed?this.speed*e*4:this.speed*e}},__decorate([s(cc.Float)],e.prototype,"speed",void 0),__decorate([s(cc.Animation)],e.prototype,"animation",void 0),e=__decorate([r],e)}(cc.Component);o.Player=c,cc._RF.pop()},{"../Constants":"Constants"}],RoomScene:[function(e,t,o){"use strict";cc._RF.push(t,"0b7efI2i5VIH4ooIk25X3s3","RoomScene"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Board"),r=e("../Constants"),s=e("./HugPanel"),n=e("./Timer"),c=e("./OverPanel"),a=cc._decorator,p=a.ccclass,l=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.board=null,e.hugPanel=null,e.timer=null,e.player1ScoreLabel=null,e.player2ScoreLabel=null,e.overPanel=null,e.player1Score=0,e.player2Score=0,e.round=0,e}return __extends(e,t),e.prototype.start=function(){this.board.init(this),this.hugPanel.init(this),cc.director.getCollisionManager().enabled=!0,this.addListeners(),this.newGame()},e.prototype.newGame=function(){this.timer.reset(60,-1,0,this.onTimerOver.bind(this)),this.timer.run(),this.round++,this.board.activePlayers(this.round)},e.prototype.onTimerOver=function(){this.board.pausePlayers(),cc.log("攻守交换"),2<=this.round?this.overGame():(this.node.getChildByName("ExchangeRole").getComponent(cc.Animation).play(),this.newGame())},e.prototype.overGame=function(){this.player1Score>this.player2Score?this.overPanel.show(!0,this.player1Score,this.player2Score):this.overPanel.show(!1,this.player2Score,this.player1Score),setTimeout(function(){cc.director.loadScene("loading")},1e4)},e.prototype.onHug=function(){cc.log("show hug panel"),this.board.pausePlayers(),this.timer.pause(),this.hugPanel.show()},e.prototype.onHugOver=function(e){cc.log(e),this.board.player1.role===r.PLAYER_ROLE.ATTACK?(this.player1Score+=e,this.player1ScoreLabel.string=this.player1Score+""):(this.player2Score+=e,this.player2ScoreLabel.string=this.player2Score+""),this.timer.resume(),this.board.activePlayers(this.round)},e.prototype.onKeyDown=function(e){switch(e.keyCode){case cc.KEY.w:this.board.movePlayer1(r.DIRECTION.UP);break;case cc.KEY.a:this.board.movePlayer1(r.DIRECTION.LEFT);break;case cc.KEY.s:this.board.movePlayer1(r.DIRECTION.DOWN);break;case cc.KEY.d:this.board.movePlayer1(r.DIRECTION.RIGHT);break;case cc.KEY.space:this.board.skillPlayer1();break;case cc.KEY.up:this.board.movePlayer2(r.DIRECTION.UP);break;case cc.KEY.left:this.board.movePlayer2(r.DIRECTION.LEFT);break;case cc.KEY.down:this.board.movePlayer2(r.DIRECTION.DOWN);break;case cc.KEY.right:this.board.movePlayer2(r.DIRECTION.RIGHT);break;case cc.KEY.enter:this.board.skillPlayer2()}},e.prototype.onKeyUp=function(e){switch(e.keyCode){case cc.KEY.w:this.board.tryStopPlayer1(r.DIRECTION.UP);break;case cc.KEY.a:this.board.tryStopPlayer1(r.DIRECTION.LEFT);break;case cc.KEY.s:this.board.tryStopPlayer1(r.DIRECTION.DOWN);break;case cc.KEY.d:this.board.tryStopPlayer1(r.DIRECTION.RIGHT);break;case cc.KEY.space:break;case cc.KEY.up:this.board.tryStopPlayer2(r.DIRECTION.UP);break;case cc.KEY.left:this.board.tryStopPlayer2(r.DIRECTION.LEFT);break;case cc.KEY.down:this.board.tryStopPlayer2(r.DIRECTION.DOWN);break;case cc.KEY.right:this.board.tryStopPlayer2(r.DIRECTION.RIGHT);break;case cc.KEY.enter:}},e.prototype.addListeners=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.removeListeners=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onDestroy=function(){this.removeListeners()},__decorate([l(i.Board)],e.prototype,"board",void 0),__decorate([l(s.HugPanel)],e.prototype,"hugPanel",void 0),__decorate([l(n.Timer)],e.prototype,"timer",void 0),__decorate([l(cc.Label)],e.prototype,"player1ScoreLabel",void 0),__decorate([l(cc.Label)],e.prototype,"player2ScoreLabel",void 0),__decorate([l(c.OverPanel)],e.prototype,"overPanel",void 0),e=__decorate([p],e)}(cc.Component);o.RoomScene=h,cc._RF.pop()},{"../Constants":"Constants","./Board":"Board","./HugPanel":"HugPanel","./OverPanel":"OverPanel","./Timer":"Timer"}],Timer:[function(e,t,o){"use strict";cc._RF.push(t,"3fe23AYFaJNW46wYatTfLY4","Timer"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,s=i.property,n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timerLabel=null,e.isRunning=!1,e.time=0,e.order=1,e.completeTime=null,e.completeCb=null,e.isTimeOver=!1,e.isPause=!1,e}return __extends(e,t),e.prototype.run=function(){this.schedule(this.tick,.1)},e.prototype.tick=function(){this.isPause||(this.time+=.1*this.order,null!==this.completeTime&&(0<this.order?this.time>=this.completeTime:this.time<=this.completeTime)&&(this.time=this.completeTime,this.isTimeOver=!0,this.stop(),this.completeCb&&this.completeCb()),this.timerLabel.string=this.time.toFixed(1)+" s")},e.prototype.stop=function(){this.unschedule(this.tick)},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1},e.prototype.reset=function(e,t,o,i){void 0===e&&(e=0),void 0===t&&(t=1),this.time=e,this.order=t,this.isTimeOver=!1,this.timerLabel.string=e+".0 s",i&&(this.completeCb=i),void 0!==o&&(this.completeTime=o)},__decorate([s(cc.Label)],e.prototype,"timerLabel",void 0),e=__decorate([r],e)}(cc.Component);o.Timer=n,cc._RF.pop()},{}]},{},["Constants","G","LoadingScene","Board","Button1","Button2","HugPanel","OverPanel","Player","RoomScene","Timer"]);