{"version":3,"sources":["Board.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/src/room","sourcesContent":["import { Player } from \"./Player\";\nimport { RoomScene } from \"./RoomScene\";\nimport { DIRECTION, PLAYER_ROLE } from \"../Constants\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport class Board extends cc.Component {\n    \n    @property(Player)\n    public player1: Player = null;\n    @property(Player)\n    public player2: Player = null;\n    \n    private roomScene: RoomScene = null;\n    \n    public init(roomScene: RoomScene) {\n        this.roomScene = roomScene;\n        this.player1.init(PLAYER_ROLE.ATTACK, this);\n        this.player2.init(PLAYER_ROLE.DEFEND, this);\n    }\n\n    public onCollide() {\n        let attactPlayer, defendPlayer;\n        if (this.player1.role === PLAYER_ROLE.ATTACK) {\n            attactPlayer = this.player1;\n            defendPlayer = this.player2;\n        } else {\n            attactPlayer = this.player2;\n            defendPlayer = this.player1;\n        }\n        this.getComponent(cc.AudioSource).play();\n        if (defendPlayer.isAddArmor) {\n            let offsetX = defendPlayer.node.x - attactPlayer.node.x;\n            let offsetY = defendPlayer.node.y - attactPlayer.node.y;\n            if (Math.abs(offsetX) > Math.abs(offsetY)) {\n                if (offsetX > 0) {\n                    attactPlayer.rebound(DIRECTION.LEFT);\n                } else {\n                    attactPlayer.rebound(DIRECTION.RIGHT);\n                }\n            } else {\n                if (offsetY > 0) {\n                    attactPlayer.rebound(DIRECTION.DOWN);\n                } else {\n                    attactPlayer.rebound(DIRECTION.UP);\n                }\n            }\n        } else{\n            this.roomScene.onHug();\n        }\n    }\n\n    public movePlayer1(dir: DIRECTION) {\n        this.player1.move(dir);\n    }\n\n    public skillPlayer1() {\n        this.player1.useSkill();\n    }\n\n    public tryStopPlayer1(dir: DIRECTION) {\n        this.player1.tryStop(dir);\n    }\n\n    public movePlayer2(dir: DIRECTION) {\n        this.player2.move(dir);\n    }\n\n    public skillPlayer2() {\n        this.player2.useSkill();\n    }\n\n    public tryStopPlayer2(dir: DIRECTION) {\n        this.player2.tryStop(dir);\n    }\n\n    public pausePlayers() {\n        this.player1.pause();\n        this.player2.pause();\n    }\n\n    public activePlayers(round: number) {\n        if (round % 2 === 1) {\n            this.player1.active(PLAYER_ROLE.ATTACK);\n            this.player2.active(PLAYER_ROLE.DEFEND);\n        } else {\n            this.player1.active(PLAYER_ROLE.DEFEND);\n            this.player2.active(PLAYER_ROLE.ATTACK);\n        }\n    }\n\n}"]}